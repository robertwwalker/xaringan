<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>All About Squares</title>
    <meta charset="utf-8" />
    <meta name="author" content="Robert W. Walker" />
    <meta name="date" content="2022-10-25" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/plotly-binding/plotly.js"></script>
    <script src="libs/typedarray/typedarray.min.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <link href="libs/crosstalk/css/crosstalk.min.css" rel="stylesheet" />
    <script src="libs/crosstalk/js/crosstalk.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# All About Squares
]
.subtitle[
## Unpacking the Black Box
]
.author[
### Robert W. Walker
]
.date[
### 2022-10-25
]

---

background-image: url("img/SquaresBG.jpg")
class: center, middle

--






![Black Box Technology](img/bbox.png)
---

.left-column[
### Summary Statistics are Insufficient

```r
load(url("https://github.com/robertwwalker/DADMStuff/raw/master/RegressionExamples.RData"))
datasaurus %&gt;% group_by(dataset) %&gt;% summarise(Mean.x = mean(x), Std.Dev.x = sd(x), Mean.y = mean(y), Std.Dev.y = sd(y)) %&gt;% kable(format="html")
```
]
.right-column[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; dataset &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Mean.x &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Std.Dev.x &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Mean.y &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Std.Dev.y &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; away &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 54.26610 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16.76983 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 47.83472 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26.93974 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; bullseye &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 54.26873 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16.76924 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 47.83082 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26.93573 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; circle &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 54.26732 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16.76001 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 47.83772 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26.93004 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; dino &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 54.26327 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16.76514 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 47.83225 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26.93540 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; dots &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 54.26030 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16.76774 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 47.83983 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26.93019 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; h_lines &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 54.26144 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16.76590 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 47.83025 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26.93988 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; high_lines &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 54.26881 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16.76670 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 47.83545 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26.94000 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; slant_down &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 54.26785 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16.76676 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 47.83590 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26.93610 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; slant_up &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 54.26588 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16.76885 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 47.83150 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26.93861 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; star &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 54.26734 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16.76896 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 47.83955 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26.93027 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; v_lines &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 54.26993 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16.76996 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 47.83699 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26.93768 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; wide_lines &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 54.26692 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16.77000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 47.83160 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26.93790 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; x_shape &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 54.26015 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16.76996 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 47.83972 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26.93000 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]


---
class: center, middle, inverse
# Relationships Matter


---

.left-column[

```r
datasaurus %&gt;% ggplot() + aes(x=x, y=y, color=dataset) + geom_point() + guides(color=FALSE) + facet_wrap(vars(dataset))
```
]
.right-column[
&lt;img src="index_files/figure-html/unnamed-chunk-3-1.svg" width="468" /&gt;
]

## Always Visualize the Data

---
class: inverse

## Models Use Inference to ...

--

## Unpack Black Boxes

--

## We will literally do it with boxes/squares


---
# Data and a Library


```r
library(tidyverse); library(patchwork); library(skimr)
load(url("https://github.com/robertwwalker/DADMStuff/raw/master/RegressionExamples.RData"))
source('https://github.com/robertwwalker/DADMStuff/raw/master/ResidPlotter.R')
source('https://github.com/robertwwalker/DADMStuff/raw/master/PlotlyReg.R')
```


---
class: inverse

## An Oregon Gender Gap

--

.pull-left[
A random sample of salaries in the 1990s for new hires from Oregon DAS.  I know *nothing* about them.  It is worth noting that these data represent a protected class by Oregon statute.  We have a state file or we can load the data from github.


```r
OregonSalaries %&gt;% 
  select(-Obs) %&gt;% 
  mutate(Row = rep(c(1:16),2)) %&gt;% 
  pivot_wider(names_from = Gender, values_from = Salary) %&gt;% select(-Row)
```
]

.pull-right[

```
# A tibble: 16 × 2
   Female   Male
    &lt;dbl&gt;  &lt;dbl&gt;
 1 41514. 47343.
 2 40964. 46382.
 3 39170. 45813.
 4 37937. 46410.
 5 33982. 43796.
 6 36077. 43124.
 7 39174. 49444.
 8 39037. 44806.
 9 29132. 44440.
10 36200. 46680.
11 38561. 47337.
12 33248. 47299.
13 33609. 41461.
14 33669. 43598.
15 37806. 43431.
16 35846. 49266.
```
]


---
## Visualising Independent Samples


```r
ggplot(OregonSalaries) + aes(x=Gender, y=Salary) + geom_boxplot() + theme_xaringan()
```

&lt;img src="index_files/figure-html/unnamed-chunk-5-1.svg" width="468" /&gt;

---
## Visualising Independent Samples


```r
ggplot(OregonSalaries) + aes(x=Gender, y=Salary, fill=Gender) + geom_violin() + theme_xaringan()
```

&lt;img src="index_files/figure-html/unnamed-chunk-6-1.svg" width="468" /&gt;


---
## About Those Squares: Deviations


The mean of all salaries is 41142.433.  Represented in equation form, we have:

`$$Salary_{i} = \alpha + \epsilon_{i}$$`

The `\(i^{th}\)` person's salary is some average salary `\(\alpha\)` [or perhaps `\(\mu\)` to maintain conceptual continuity] (shown as a solid blue line) plus some idiosyncratic remainder or residual salary for individual `\(i\)` denoted by `\(\epsilon_{i}\)` (shown as a blue arrow).  Everything here is measured in dollars.

`$$Salary_{i}  = 41142.433 + \epsilon_{i}$$`




---
class: left
background-image: url("img/Dev1.png")
background-position: right

--


```
# A tibble: 16 × 2
   Female[,1] Male[,1]
        &lt;dbl&gt;    &lt;dbl&gt;
 1       372.    6200.
 2      -178.    5240.
 3     -1972.    4670.
 4     -3206.    5267.
 5     -7161.    2654.
 6     -5065.    1982.
 7     -1968.    8301.
 8     -2105.    3663.
 9    -12011.    3298.
10     -4942.    5537.
11     -2581.    6195.
12     -7895.    6156.
13     -7533.     319.
14     -7473.    2456.
15     -3337.    2289.
16     -5296.    8124.
```

---

By definition, those vertical distances would/will sum to zero.  **This sum to zero constraint is what consumes a degree of freedom; it is why the standard deviation has N-1 degrees of freedom.**  The distance from the point to the line is also shown in blue; that is the observed residual salary.  It shows how far that individual's salary is from the overall average.

---
class: left
background-image: url("img/Dev2.png")
background-position: right

# A Big Black Box
--


```
# A tibble: 16 × 2
   Female[,1]  Male[,1]
        &lt;dbl&gt;     &lt;dbl&gt;
 1    138350. 38442803.
 2     31813. 27457097.
 3   3889736. 21813358.
 4  10277545. 27743644.
 5  51274988.  7041698.
 6  25655866.  3926692.
 7   3874503. 68912991.
 8   4431282. 13420200.
 9 144256540. 10876058.
10  24423237. 30660131.
11   6661738. 38373872.
12  62323288. 37899934.
13  56745270.   101515.
14  55848872.  6031248.
15  11132919.  5238385.
16  28050778. 65999032.
```

```
  sum(Salary.Deviation.Squared)
1                     892955384
```

---
## The Black Box of Salaries

The total area of the `black box` in the original metric (squared dollars) is: 892955385.  The length of each side is the square root of that area, e.g. 29882.36 in dollars.

![](img/Dev3.png)

---
class: inverse
background-image: url("img/Dev3.png")
background-position: bottom

This square, when averaged by degrees of freedom and called *mean square*, has a known distribution, `\(\chi^2\)` *if we assume that the deviations, call them errors, are normal.*

---
# The `\(\chi^2\)` distribution

The `\(\chi^2\)` [chi-squared] distribution can be derived as the sum of `\(k\)` squared `\(Z\)` or standard normal variables.  Because they are squares, they are always positive.  The `\(k\)` is called *degrees of freedom*.  Differences in `\(\chi^2\)` also have a `\(\chi^2\)` distribution with degrees of freedom equal to the difference in degrees of freedom.

As a technical matter (for x &gt; 0): `$$f(x) = \frac{1}{2^{\frac{k}{2}}\Gamma(k/2)} x^{\frac{k}{2-1}}e^{\frac{-x}{2}}$$`

---
# Some language and `\(F\)`

*Sum of squares*: `$$\sum_{i=1}^{N} e_{i}^{2}$$`
*Mean square*: divide the sum of squares by `\(k\)` degrees of freedom.  NB: Take the square root and you get the standard deviation. `$$\frac{1}{k}\sum_{i=1}^{N} e_{i}^{2}$$`

Fisher's `\(F\)` ratio or the `\(F\)` describes the ratio of two `\(\chi^2\)` variables (mean square) with numerator and denominator degrees of freedom.  It is the ratio of [degrees of freedom] averaged squared errors.  As the ratio becomes large, we obtain greater evidence that the two are not the same.  Let's try that here.

---
# The Core Conditional

But all of this stems from the presumption that `\(e_{i}\)` is normal; that is a claim that cannot really be proven or disproven.  *It is a core assumption that we should try to verify/falsify.*

Because the `\(e_{i}\)` being normal means implies that their squares are `\(\chi^2\)`&lt;sup&gt;a&lt;/sup&gt; and further that the ratio of their mean-squares are `\(F\)`.

As an aside, the technical definition of `\(t\)`&lt;sup&gt;b&lt;/sup&gt;   is a normal divided by the square root of a `\(\chi^2\)` so `\(t\)` and `\(F\)` must be equivalent with one degree of freedom in the numerator.

.footnote[

&lt;sup&gt;a&lt;/sup&gt; This is why the various results in prop.test are reported as X-squared.

&lt;sup&gt;b&lt;/sup&gt; I mentioned this fact previously when introducing t (defined by degrees of freedom and with metric standard error.)

]

---

# Verification of the Normal

1. Plots [shape]
2. the quantile-quantile plot
3. Statistical tests

---
# plots


```r
plot(density(lm(OregonSalaries$Salary~1)$residuals), main="Residual Salary")
```

&lt;img src="index_files/figure-html/unnamed-chunk-7-1.svg" width="468" /&gt;

---
### the quantile-quantile plot of a normal

.pull-left[
The mean of residual salary is zero.  The standard deviation is the root-mean-square.  Compare observed residual salary [as z] to the hypothetical normal.


```r
data.frame(x=scale(lm(OregonSalaries$Salary~1)$residuals)) %&gt;% arrange(x) %&gt;%  mutate(y=qnorm(seq(1, length(OregonSalaries$Salary))/33)) %&gt;% ggplot() + aes(x=x, y=y) + geom_point()
```
]

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-9-1.svg" width="468" /&gt;
]

---
## tests

We can examine the claim that residual salary is plausibly normal by examining the slope of the sample and theoretical quantiles: the slope of the q-q plot.  This is exactly what the following does under the null hypothesis of a normal.


```r
shapiro.test(lm(Salary~1, data=OregonSalaries)$residuals)
```

```

	Shapiro-Wilk normality test

data:  lm(Salary ~ 1, data = OregonSalaries)$residuals
W = 0.9591, p-value = 0.2595
```

---
## Linear Models

Will expand on the previous by unpacking the box, reducing residual squares via the inclusion of *features, explanatory variables, explanatory factors, exogenous inputs, predictor variables*.  In this case, let us posit that salary is a function of gender.  As an equation, that yields:

`$$Salary_{i} = \alpha + \beta_{1}*Gender_{i} + \epsilon_{i}$$`
We want to measure that `\(\beta\)`; in this case, the difference between Male and Female.  By default, R will include Female as the constant.

What does the regression imply?  That salary for each individual `\(i\)` is a function of a constant and gender.  Given the way that R works, `\(\alpha\)` will represent the average for females and `\(\beta\)` will represent the difference between male and female average salaries.  The `\(\epsilon\)` will capture the difference between the individual's salary and the average of their group (the mean of males or females).


---
## A New Residual Sum of Squares

.pull-left[
The picture will now have a red line and a black line and the residual/leftover/unexplained salary is now the difference between the point and the respective vertical line (red arrows or black arrows).  What is the relationship between the datum and the group mean?  The answer is shown in black/red.  
]
.pull-right[

&lt;img src="index_files/figure-html/BasePlot-1.svg" width="468" /&gt;
]



---
## The Squares

The sum of the remaining squared vertical distances is 238621277 and is obtained by squaring each black/red number and summing them.  The amount explained by gender [measured in squared dollars] is the difference between the sums of blue and black/red numbers, squared.  It is important to notice that the highest paid females and the lowest paid males may have more residual salary given two averages but the different averages, overall, lead to far less residual salary than a single average for all salaries.  Indeed, gender alone accounts for:


```r
sum(scale(OregonSalaries$Salary, scale = FALSE)^2) - sum(lm(Salary~Gender, data=OregonSalaries)$residuals^2)
```

```
[1] 654334108
```

Intuitively, *Gender* should account for 16 times the squared difference between Female and Overall Average (4522) and 16 times the squared difference between Male and Overall Average (4522).


```r
32*(mean(OregonSalaries$Salary[OregonSalaries$Gender=="Female"], na.rm=TRUE)-mean(OregonSalaries$Salary))^2
```

```
[1] 654334108
```

---
## A Visual: What Proportion is Accounted For?

&lt;img src="index_files/figure-html/BBReg-1.svg" width="468" /&gt;


---
## Regression Tables


```r
Model.1 &lt;- lm(Salary~Gender, data=OregonSalaries)
summary(Model.1)
```

```

Call:
lm(formula = Salary ~ Gender, data = OregonSalaries)

Residuals:
    Min      1Q  Median      3Q     Max 
-7488.7 -2107.9   433.3  1743.9  4893.9 

Coefficients:
            Estimate Std. Error t value       Pr(&gt;|t|)    
(Intercept)  36620.5      705.1   51.94        &lt; 2e-16 ***
GenderMale    9043.9      997.1    9.07 0.000000000422 ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2820 on 30 degrees of freedom
Multiple R-squared:  0.7328,	Adjusted R-squared:  0.7239 
F-statistic: 82.26 on 1 and 30 DF,  p-value: 0.0000000004223
```

---
class: inverse
background-image: url("img/Fbox.png")
background-position: bottom
background-size: 600px 150px


## Analysis of Variance: The Squares

F is the ratio of the two mean squares.  It is also `\(t^2\)`.

.small[

```r
anova(Model.1)
```

```
Analysis of Variance Table

Response: Salary
          Df    Sum Sq   Mean Sq F value          Pr(&gt;F)
Gender     1 654334108 654334108  82.264 0.0000000004223
Residuals 30 238621277   7954043                        
             
Gender    ***
Residuals    
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```
]

---
background-image: url("img/F130.jpg")
background-size: contain

---
background-image: url("img/radiant-ORSlm.jpg")
background-size: contain


---
class: center, middle, inverse
# The Idea Scales to both Quantitative Variables and Multiple Categories

---
### A Multi-Category Example


```r
Model.2 &lt;- lm(Expenditures~Age.Cohort, data=WH)
summary(Model.2)
```

```

Call:
lm(formula = Expenditures ~ Age.Cohort, data = WH)

Residuals:
     Min       1Q   Median       3Q      Max 
-20157.4  -1175.2     21.9   1160.9  16348.4 

Coefficients:
                Estimate Std. Error t value        Pr(&gt;|t|)
(Intercept)       2224.9      330.0   6.742 0.0000000000307
Age.Cohort0 - 5   -839.9      584.9  -1.436        0.151368
Age.Cohort13-17   1710.3      443.5   3.856        0.000125
Age.Cohort18-21   7816.2      458.7  17.040         &lt; 2e-16
Age.Cohort22-50  38142.7      440.1  86.668         &lt; 2e-16
Age.Cohort51 +   51042.5      537.3  95.000         &lt; 2e-16
                   
(Intercept)     ***
Age.Cohort0 - 5    
Age.Cohort13-17 ***
Age.Cohort18-21 ***
Age.Cohort22-50 ***
Age.Cohort51 +  ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3863 on 771 degrees of freedom
Multiple R-squared:  0.9613,	Adjusted R-squared:  0.9611 
F-statistic:  3833 on 5 and 771 DF,  p-value: &lt; 2.2e-16
```

---
## `anova`


```r
anova(Model.2)
```

```
Analysis of Variance Table

Response: Expenditures
            Df       Sum Sq     Mean Sq F value    Pr(&gt;F)
Age.Cohort   5 285981965642 57196393128  3833.3 &lt; 2.2e-16
Residuals  771  11503984348    14920862                  
              
Age.Cohort ***
Residuals     
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

```r
confint(Model.2)
```

```
                     2.5 %     97.5 %
(Intercept)      1577.0735  2872.7514
Age.Cohort0 - 5 -1988.0158   308.1598
Age.Cohort13-17   839.7131  2580.8856
Age.Cohort18-21  6915.7707  8716.7038
Age.Cohort22-50 37278.7115 39006.5887
Age.Cohort51 +  49987.7479 52097.1984
```

---
# Not Alot Left....


```r
black.box.maker(Model.2)
```

&lt;img src="index_files/figure-html/unnamed-chunk-17-1.svg" width="468" /&gt;

---
class: center, middle
# Bullseye

![bullseye](https://media1.giphy.com/media/Z61gwKI72Gx2g/giphy.gif)  


---
class: inverse
## Messy


```r
qqnorm(residuals(Model.2))
```

&lt;img src="index_files/figure-html/unnamed-chunk-18-1.svg" width="468" /&gt;

---
## What about Ethnicity?


```r
Model.3 &lt;- lm(Expenditures ~ Ethnicity + Age.Cohort, data=WH)
summary(Model.3)
```

```

Call:
lm(formula = Expenditures ~ Ethnicity + Age.Cohort, data = WH)

Residuals:
     Min       1Q   Median       3Q      Max 
-20075.0  -1206.7      0.1   1202.1  16446.7 

Coefficients:
                            Estimate Std. Error t value
(Intercept)                   2359.9      344.7   6.846
EthnicityWhite not Hispanic   -402.1      298.3  -1.348
Age.Cohort0 - 5               -849.3      584.6  -1.453
Age.Cohort13-17               1733.8      443.6   3.908
Age.Cohort18-21               7870.0      460.2  17.101
Age.Cohort22-50              38311.5      457.4  83.768
Age.Cohort51 +               51227.2      554.2  92.432
                                   Pr(&gt;|t|)    
(Intercept)                 0.0000000000155 ***
EthnicityWhite not Hispanic        0.178045    
Age.Cohort0 - 5                    0.146685    
Age.Cohort13-17                    0.000101 ***
Age.Cohort18-21                     &lt; 2e-16 ***
Age.Cohort22-50                     &lt; 2e-16 ***
Age.Cohort51 +                      &lt; 2e-16 ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3861 on 770 degrees of freedom
Multiple R-squared:  0.9614,	Adjusted R-squared:  0.9611 
F-statistic:  3198 on 6 and 770 DF,  p-value: &lt; 2.2e-16
```


---
class: inverse


```r
confint(Model.3)
```

```
                                 2.5 %     97.5 %
(Intercept)                  1683.2345  3036.6106
EthnicityWhite not Hispanic  -987.6405   183.4497
Age.Cohort0 - 5             -1996.8464   298.2797
Age.Cohort13-17               862.9646  2604.5597
Age.Cohort18-21              6966.5797  8773.3519
Age.Cohort22-50             37413.6880 39209.3043
Age.Cohort51 +              50139.2506 52315.1525
```

---
class: inverse


```r
anova(Model.2, Model.3)
```

```
Analysis of Variance Table

Model 1: Expenditures ~ Age.Cohort
Model 2: Expenditures ~ Ethnicity + Age.Cohort
  Res.Df         RSS Df Sum of Sq      F Pr(&gt;F)
1    771 11503984348                           
2    770 11476899027  1  27085321 1.8172  0.178
```

At the margin, *Ethnicity* accounts for little variance.


---
# Some Basic Cost Accounting

`$$Total.Cost_{t} = \alpha + \beta*units_t + \epsilon_{t}$$`

With data on per period (t) costs and units produced, we can partition fixed `\(\alpha\)` and variable costs `\(\beta\)` (or cost per unit).  Consider the data on Handmade Bags.  We want to accomplish two things.  First, to measure the two key quantities.  Second, be able to predict costs for hypothetical number of units.

**A comment on correlation**

---
# The Data


```r
HMB %&gt;% skim() %&gt;% kable(format = "html", digits = 3)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; skim_type &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; skim_variable &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; n_missing &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; complete_rate &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; numeric.mean &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; numeric.sd &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; numeric.p0 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; numeric.p25 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; numeric.p50 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; numeric.p75 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; numeric.p100 &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; numeric.hist &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; numeric &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; units &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 351.967 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 131.665 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 141.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 241.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 356.00 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 457.0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 580.00 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ▇▇▆▇▆ &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; numeric &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; TotCost &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 19946.865 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2985.202 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14357.98 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 17593.8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20073.93 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 22415.2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 24887.83 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ▆▇▇▇▇ &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


---
class: inverse
### A Look at the Data


```r
p1 &lt;- ggplot(HMB) + aes(x=units, y=TotCost) + geom_point() + labs(y="Total Costs per period", x="Units")
plotly::ggplotly(p1)
```

<div id="htmlwidget-14ec74098c2af242e27f" style="width:468px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-14ec74098c2af242e27f">{"x":{"data":[{"x":[268,279,430,141,412,574,456,196,386,258,450,316,352,292,263,525,143,267,326,460,580,566,176,209,400,447,360,189,151,471,405,506,376,269,483,434,173,217,231,174,186,290,206,172,470,159,544,428,438,490,245,546,554,398,349,332,393,296,517,494],"y":[19624.30773,16790.41492,21489.10677,15998.02674,23771.94567,24365.4756,23724.83788,16928.97483,20738.20892,17747.66292,21480.21451,17559.58997,19731.90741,19295.2005,17828.957,24175.42698,14357.98395,18524.81363,20087.48175,22301.03134,24627.96587,23409.5391,15309.48682,16182.97191,20755.60117,22430.95432,19190.33155,18167.35708,15246.06305,21328.64645,20245.94196,23880.93212,20126.65678,18376.04508,23284.72698,21969.43476,14994.43448,15726.92079,16424.78712,17410.3598,17605.20581,19545.99434,15300.08244,17178.10077,22409.95135,15485.60432,24240.0031,20774.9159,21635.60254,22734.84517,18000.14228,24441.09039,24887.82916,20616.76379,20561.77933,19694.49895,20060.38617,18999.21016,23251.12337,23778.02921],"text":["units: 268<br />TotCost: 19624.31","units: 279<br />TotCost: 16790.41","units: 430<br />TotCost: 21489.11","units: 141<br />TotCost: 15998.03","units: 412<br />TotCost: 23771.95","units: 574<br />TotCost: 24365.48","units: 456<br />TotCost: 23724.84","units: 196<br />TotCost: 16928.97","units: 386<br />TotCost: 20738.21","units: 258<br />TotCost: 17747.66","units: 450<br />TotCost: 21480.21","units: 316<br />TotCost: 17559.59","units: 352<br />TotCost: 19731.91","units: 292<br />TotCost: 19295.20","units: 263<br />TotCost: 17828.96","units: 525<br />TotCost: 24175.43","units: 143<br />TotCost: 14357.98","units: 267<br />TotCost: 18524.81","units: 326<br />TotCost: 20087.48","units: 460<br />TotCost: 22301.03","units: 580<br />TotCost: 24627.97","units: 566<br />TotCost: 23409.54","units: 176<br />TotCost: 15309.49","units: 209<br />TotCost: 16182.97","units: 400<br />TotCost: 20755.60","units: 447<br />TotCost: 22430.95","units: 360<br />TotCost: 19190.33","units: 189<br />TotCost: 18167.36","units: 151<br />TotCost: 15246.06","units: 471<br />TotCost: 21328.65","units: 405<br />TotCost: 20245.94","units: 506<br />TotCost: 23880.93","units: 376<br />TotCost: 20126.66","units: 269<br />TotCost: 18376.05","units: 483<br />TotCost: 23284.73","units: 434<br />TotCost: 21969.43","units: 173<br />TotCost: 14994.43","units: 217<br />TotCost: 15726.92","units: 231<br />TotCost: 16424.79","units: 174<br />TotCost: 17410.36","units: 186<br />TotCost: 17605.21","units: 290<br />TotCost: 19545.99","units: 206<br />TotCost: 15300.08","units: 172<br />TotCost: 17178.10","units: 470<br />TotCost: 22409.95","units: 159<br />TotCost: 15485.60","units: 544<br />TotCost: 24240.00","units: 428<br />TotCost: 20774.92","units: 438<br />TotCost: 21635.60","units: 490<br />TotCost: 22734.85","units: 245<br />TotCost: 18000.14","units: 546<br />TotCost: 24441.09","units: 554<br />TotCost: 24887.83","units: 398<br />TotCost: 20616.76","units: 349<br />TotCost: 20561.78","units: 332<br />TotCost: 19694.50","units: 393<br />TotCost: 20060.39","units: 296<br />TotCost: 18999.21","units: 517<br />TotCost: 23251.12","units: 494<br />TotCost: 23778.03"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(55,17,66,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(55,17,66,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":23.9147640791476,"r":7.30593607305936,"b":37.869101978691,"l":54.7945205479452},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[119.05,601.95],"tickmode":"array","ticktext":["200","300","400","500","600"],"tickvals":[200,300,400,500,600],"categoryorder":"array","categoryarray":["200","300","400","500","600"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Units","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[13831.4916895,25414.3214205],"tickmode":"array","ticktext":["15000","17500","20000","22500","25000"],"tickvals":[15000,17500,20000,22500,25000],"categoryorder":"array","categoryarray":["15000","17500","20000","22500","25000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Total Costs per period","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"c9aa3d1a3f9":{"x":{},"y":{},"type":"scatter"}},"cur_data":"c9aa3d1a3f9","visdat":{"c9aa3d1a3f9":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>

---
## The Thing to Measure


```r
p1 &lt;- ggplot(HMB) + aes(x=units, y=TotCost) + geom_point() + geom_smooth(method="lm") + labs(y="Total Costs per period", x="Units")
plotly::ggplotly(p1)
```

<div id="htmlwidget-d7e74c158c5df6cbf674" style="width:468px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-d7e74c158c5df6cbf674">{"x":{"data":[{"x":[268,279,430,141,412,574,456,196,386,258,450,316,352,292,263,525,143,267,326,460,580,566,176,209,400,447,360,189,151,471,405,506,376,269,483,434,173,217,231,174,186,290,206,172,470,159,544,428,438,490,245,546,554,398,349,332,393,296,517,494],"y":[19624.30773,16790.41492,21489.10677,15998.02674,23771.94567,24365.4756,23724.83788,16928.97483,20738.20892,17747.66292,21480.21451,17559.58997,19731.90741,19295.2005,17828.957,24175.42698,14357.98395,18524.81363,20087.48175,22301.03134,24627.96587,23409.5391,15309.48682,16182.97191,20755.60117,22430.95432,19190.33155,18167.35708,15246.06305,21328.64645,20245.94196,23880.93212,20126.65678,18376.04508,23284.72698,21969.43476,14994.43448,15726.92079,16424.78712,17410.3598,17605.20581,19545.99434,15300.08244,17178.10077,22409.95135,15485.60432,24240.0031,20774.9159,21635.60254,22734.84517,18000.14228,24441.09039,24887.82916,20616.76379,20561.77933,19694.49895,20060.38617,18999.21016,23251.12337,23778.02921],"text":["units: 268<br />TotCost: 19624.31","units: 279<br />TotCost: 16790.41","units: 430<br />TotCost: 21489.11","units: 141<br />TotCost: 15998.03","units: 412<br />TotCost: 23771.95","units: 574<br />TotCost: 24365.48","units: 456<br />TotCost: 23724.84","units: 196<br />TotCost: 16928.97","units: 386<br />TotCost: 20738.21","units: 258<br />TotCost: 17747.66","units: 450<br />TotCost: 21480.21","units: 316<br />TotCost: 17559.59","units: 352<br />TotCost: 19731.91","units: 292<br />TotCost: 19295.20","units: 263<br />TotCost: 17828.96","units: 525<br />TotCost: 24175.43","units: 143<br />TotCost: 14357.98","units: 267<br />TotCost: 18524.81","units: 326<br />TotCost: 20087.48","units: 460<br />TotCost: 22301.03","units: 580<br />TotCost: 24627.97","units: 566<br />TotCost: 23409.54","units: 176<br />TotCost: 15309.49","units: 209<br />TotCost: 16182.97","units: 400<br />TotCost: 20755.60","units: 447<br />TotCost: 22430.95","units: 360<br />TotCost: 19190.33","units: 189<br />TotCost: 18167.36","units: 151<br />TotCost: 15246.06","units: 471<br />TotCost: 21328.65","units: 405<br />TotCost: 20245.94","units: 506<br />TotCost: 23880.93","units: 376<br />TotCost: 20126.66","units: 269<br />TotCost: 18376.05","units: 483<br />TotCost: 23284.73","units: 434<br />TotCost: 21969.43","units: 173<br />TotCost: 14994.43","units: 217<br />TotCost: 15726.92","units: 231<br />TotCost: 16424.79","units: 174<br />TotCost: 17410.36","units: 186<br />TotCost: 17605.21","units: 290<br />TotCost: 19545.99","units: 206<br />TotCost: 15300.08","units: 172<br />TotCost: 17178.10","units: 470<br />TotCost: 22409.95","units: 159<br />TotCost: 15485.60","units: 544<br />TotCost: 24240.00","units: 428<br />TotCost: 20774.92","units: 438<br />TotCost: 21635.60","units: 490<br />TotCost: 22734.85","units: 245<br />TotCost: 18000.14","units: 546<br />TotCost: 24441.09","units: 554<br />TotCost: 24887.83","units: 398<br />TotCost: 20616.76","units: 349<br />TotCost: 20561.78","units: 332<br />TotCost: 19694.50","units: 393<br />TotCost: 20060.39","units: 296<br />TotCost: 18999.21","units: 517<br />TotCost: 23251.12","units: 494<br />TotCost: 23778.03"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(55,17,66,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(55,17,66,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[141,146.556962025316,152.113924050633,157.670886075949,163.227848101266,168.784810126582,174.341772151899,179.898734177215,185.455696202532,191.012658227848,196.569620253165,202.126582278481,207.683544303797,213.240506329114,218.79746835443,224.354430379747,229.911392405063,235.46835443038,241.025316455696,246.582278481013,252.139240506329,257.696202531646,263.253164556962,268.810126582278,274.367088607595,279.924050632911,285.481012658228,291.037974683544,296.594936708861,302.151898734177,307.708860759494,313.26582278481,318.822784810127,324.379746835443,329.936708860759,335.493670886076,341.050632911392,346.607594936709,352.164556962025,357.721518987342,363.278481012658,368.835443037975,374.392405063291,379.949367088608,385.506329113924,391.063291139241,396.620253164557,402.177215189873,407.73417721519,413.291139240506,418.848101265823,424.405063291139,429.962025316456,435.518987341772,441.075949367089,446.632911392405,452.189873417722,457.746835443038,463.303797468354,468.860759493671,474.417721518987,479.974683544304,485.53164556962,491.088607594937,496.645569620253,502.20253164557,507.759493670886,513.316455696203,518.873417721519,524.430379746835,529.987341772152,535.544303797468,541.101265822785,546.658227848101,552.215189873418,557.772151898734,563.329113924051,568.886075949367,574.443037974684,580],"y":[15368.5608538923,15489.155549115,15609.7502443376,15730.3449395602,15850.9396347828,15971.5343300055,16092.1290252281,16212.7237204507,16333.3184156734,16453.913110896,16574.5078061186,16695.1025013413,16815.6971965639,16936.2918917865,17056.8865870091,17177.4812822318,17298.0759774544,17418.670672677,17539.2653678997,17659.8600631223,17780.4547583449,17901.0494535676,18021.6441487902,18142.2388440128,18262.8335392355,18383.4282344581,18504.0229296807,18624.6176249033,18745.212320126,18865.8070153486,18986.4017105712,19106.9964057939,19227.5911010165,19348.1857962391,19468.7804914618,19589.3751866844,19709.969881907,19830.5645771296,19951.1592723523,20071.7539675749,20192.3486627975,20312.9433580202,20433.5380532428,20554.1327484654,20674.7274436881,20795.3221389107,20915.9168341333,21036.511529356,21157.1062245786,21277.7009198012,21398.2956150238,21518.8903102465,21639.4850054691,21760.0797006917,21880.6743959144,22001.269091137,22121.8637863596,22242.4584815823,22363.0531768049,22483.6478720275,22604.2425672501,22724.8372624728,22845.4319576954,22966.026652918,23086.6213481407,23207.2160433633,23327.8107385859,23448.4054338086,23569.0001290312,23689.5948242538,23810.1895194765,23930.7842146991,24051.3789099217,24171.9736051443,24292.568300367,24413.1629955896,24533.7576908122,24654.3523860349,24774.9470812575,24895.5417764801],"text":["units: 141.0000<br />TotCost: 15368.56","units: 146.5570<br />TotCost: 15489.16","units: 152.1139<br />TotCost: 15609.75","units: 157.6709<br />TotCost: 15730.34","units: 163.2278<br />TotCost: 15850.94","units: 168.7848<br />TotCost: 15971.53","units: 174.3418<br />TotCost: 16092.13","units: 179.8987<br />TotCost: 16212.72","units: 185.4557<br />TotCost: 16333.32","units: 191.0127<br />TotCost: 16453.91","units: 196.5696<br />TotCost: 16574.51","units: 202.1266<br />TotCost: 16695.10","units: 207.6835<br />TotCost: 16815.70","units: 213.2405<br />TotCost: 16936.29","units: 218.7975<br />TotCost: 17056.89","units: 224.3544<br />TotCost: 17177.48","units: 229.9114<br />TotCost: 17298.08","units: 235.4684<br />TotCost: 17418.67","units: 241.0253<br />TotCost: 17539.27","units: 246.5823<br />TotCost: 17659.86","units: 252.1392<br />TotCost: 17780.45","units: 257.6962<br />TotCost: 17901.05","units: 263.2532<br />TotCost: 18021.64","units: 268.8101<br />TotCost: 18142.24","units: 274.3671<br />TotCost: 18262.83","units: 279.9241<br />TotCost: 18383.43","units: 285.4810<br />TotCost: 18504.02","units: 291.0380<br />TotCost: 18624.62","units: 296.5949<br />TotCost: 18745.21","units: 302.1519<br />TotCost: 18865.81","units: 307.7089<br />TotCost: 18986.40","units: 313.2658<br />TotCost: 19107.00","units: 318.8228<br />TotCost: 19227.59","units: 324.3797<br />TotCost: 19348.19","units: 329.9367<br />TotCost: 19468.78","units: 335.4937<br />TotCost: 19589.38","units: 341.0506<br />TotCost: 19709.97","units: 346.6076<br />TotCost: 19830.56","units: 352.1646<br />TotCost: 19951.16","units: 357.7215<br />TotCost: 20071.75","units: 363.2785<br />TotCost: 20192.35","units: 368.8354<br />TotCost: 20312.94","units: 374.3924<br />TotCost: 20433.54","units: 379.9494<br />TotCost: 20554.13","units: 385.5063<br />TotCost: 20674.73","units: 391.0633<br />TotCost: 20795.32","units: 396.6203<br />TotCost: 20915.92","units: 402.1772<br />TotCost: 21036.51","units: 407.7342<br />TotCost: 21157.11","units: 413.2911<br />TotCost: 21277.70","units: 418.8481<br />TotCost: 21398.30","units: 424.4051<br />TotCost: 21518.89","units: 429.9620<br />TotCost: 21639.49","units: 435.5190<br />TotCost: 21760.08","units: 441.0759<br />TotCost: 21880.67","units: 446.6329<br />TotCost: 22001.27","units: 452.1899<br />TotCost: 22121.86","units: 457.7468<br />TotCost: 22242.46","units: 463.3038<br />TotCost: 22363.05","units: 468.8608<br />TotCost: 22483.65","units: 474.4177<br />TotCost: 22604.24","units: 479.9747<br />TotCost: 22724.84","units: 485.5316<br />TotCost: 22845.43","units: 491.0886<br />TotCost: 22966.03","units: 496.6456<br />TotCost: 23086.62","units: 502.2025<br />TotCost: 23207.22","units: 507.7595<br />TotCost: 23327.81","units: 513.3165<br />TotCost: 23448.41","units: 518.8734<br />TotCost: 23569.00","units: 524.4304<br />TotCost: 23689.59","units: 529.9873<br />TotCost: 23810.19","units: 535.5443<br />TotCost: 23930.78","units: 541.1013<br />TotCost: 24051.38","units: 546.6582<br />TotCost: 24171.97","units: 552.2152<br />TotCost: 24292.57","units: 557.7722<br />TotCost: 24413.16","units: 563.3291<br />TotCost: 24533.76","units: 568.8861<br />TotCost: 24654.35","units: 574.4430<br />TotCost: 24774.95","units: 580.0000<br />TotCost: 24895.54"],"type":"scatter","mode":"lines","name":"fitted values","line":{"width":3.77952755905512,"color":"rgba(28,82,83,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[141,146.556962025316,152.113924050633,157.670886075949,163.227848101266,168.784810126582,174.341772151899,179.898734177215,185.455696202532,191.012658227848,196.569620253165,202.126582278481,207.683544303797,213.240506329114,218.79746835443,224.354430379747,229.911392405063,235.46835443038,241.025316455696,246.582278481013,252.139240506329,257.696202531646,263.253164556962,268.810126582278,274.367088607595,279.924050632911,285.481012658228,291.037974683544,296.594936708861,302.151898734177,307.708860759494,313.26582278481,318.822784810127,324.379746835443,329.936708860759,335.493670886076,341.050632911392,346.607594936709,352.164556962025,357.721518987342,363.278481012658,368.835443037975,374.392405063291,379.949367088608,385.506329113924,391.063291139241,396.620253164557,402.177215189873,407.73417721519,413.291139240506,418.848101265823,424.405063291139,429.962025316456,435.518987341772,441.075949367089,446.632911392405,452.189873417722,457.746835443038,463.303797468354,468.860759493671,474.417721518987,479.974683544304,485.53164556962,491.088607594937,496.645569620253,502.20253164557,507.759493670886,513.316455696203,518.873417721519,524.430379746835,529.987341772152,535.544303797468,541.101265822785,546.658227848101,552.215189873418,557.772151898734,563.329113924051,568.886075949367,574.443037974684,580,580,580,574.443037974684,568.886075949367,563.329113924051,557.772151898734,552.215189873418,546.658227848101,541.101265822785,535.544303797468,529.987341772152,524.430379746835,518.873417721519,513.316455696203,507.759493670886,502.20253164557,496.645569620253,491.088607594937,485.53164556962,479.974683544304,474.417721518987,468.860759493671,463.303797468354,457.746835443038,452.189873417722,446.632911392405,441.075949367089,435.518987341772,429.962025316456,424.405063291139,418.848101265823,413.291139240506,407.73417721519,402.177215189873,396.620253164557,391.063291139241,385.506329113924,379.949367088608,374.392405063291,368.835443037975,363.278481012658,357.721518987342,352.164556962025,346.607594936709,341.050632911392,335.493670886076,329.936708860759,324.379746835443,318.822784810127,313.26582278481,307.708860759494,302.151898734177,296.594936708861,291.037974683544,285.481012658228,279.924050632911,274.367088607595,268.810126582278,263.253164556962,257.696202531646,252.139240506329,246.582278481013,241.025316455696,235.46835443038,229.911392405063,224.354430379747,218.79746835443,213.240506329114,207.683544303797,202.126582278481,196.569620253165,191.012658227848,185.455696202532,179.898734177215,174.341772151899,168.784810126582,163.227848101266,157.670886075949,152.113924050633,146.556962025316,141,141],"y":[14940.4643234396,15069.1821227809,15197.8369057558,15326.4248999361,15454.942060861,15583.3840512117,15711.7462186542,15840.0235723692,15968.210758322,16096.3020333734,16224.2912383912,16352.1717705977,16479.9365554823,16607.5780187231,16735.0880586986,16862.4580203368,16989.6786712394,17116.7401812389,17243.6321067921,17370.3433818761,17496.8623173312,17623.1766108605,17749.2733701415,17875.1391516825,18000.7600181429,18126.1216167695,18251.2092813376,18376.0081594674,18500.5033663588,18624.6801648385,18748.5241701147,18872.0215758566,18995.159396234,19117.9257165341,19240.3099431255,19362.3030421091,19483.8977552293,19605.0887817261,19725.8729159107,19846.2491323313,19966.2186133317,20085.7847172903,20204.9528895102,20323.7305211916,20442.1267647972,20560.1523161403,20677.8191745546,20795.1403925447,20912.1298254952,21028.8018905468,21145.1713418824,21261.2530676425,21377.0619117188,21492.6125219128,21607.9192244728,21722.9959238967,21837.856026083,21952.5123824147,22066.9772521147,22181.2622801526,22295.3784880834,22409.3362753758,22523.1454290404,22636.815139633,22750.3540219848,22863.7701392762,22977.0710293113,23090.2637320709,23203.3548178091,23316.3504151229,23429.2562385598,23542.077615442,23654.8195116776,23767.4865564035,23880.0830653633,23992.6130629696,24105.0803030356,24217.4882881865,24329.8402879815,24442.1393557922,24442.1393557922,25348.9441971681,25220.0538745335,25091.2164838833,24962.4350785889,24833.7129282096,24705.0535353707,24576.4606538852,24447.9383081658,24319.4908139562,24191.1228003931,24062.8392333848,23934.6454402533,23806.5471355463,23678.5504478606,23550.6619474504,23422.8886742965,23295.2381662031,23167.7184863504,23040.3382495698,22913.1066464169,22786.0334639024,22659.1291014951,22532.4045807498,22405.8715466363,22279.5422583773,22153.429567356,22027.5468794707,21901.9080992194,21776.5275528505,21651.4198881653,21526.5999490556,21402.0826236619,21277.8826661672,21154.0144937121,21030.4919616811,20907.3281225789,20784.5349757393,20662.1232169754,20540.10199875,20418.4787122634,20297.2588028185,20176.4456287939,20056.0403725332,19936.0420085848,19816.4473312597,19697.251039798,19578.4458759441,19460.0228057989,19341.9712357311,19224.2792510278,19106.9338658587,18989.9212738931,18873.2270903393,18756.8365780238,18640.7348521467,18524.907060328,18409.3385363431,18294.0149274389,18178.9222962746,18064.0471993587,17949.3767443685,17834.8986290073,17720.6011641152,17606.4732836694,17492.5045441267,17378.6851153197,17265.0057648499,17151.4578376455,17038.0332320848,16924.7243738461,16811.5241884186,16698.4260730248,16585.4238685323,16472.511831802,16359.6846087993,16246.9372087047,16134.2649791844,16021.6635829193,15909.128975449,15796.6573843451,14940.4643234396],"text":["units: 141.0000<br />TotCost: 15368.56","units: 146.5570<br />TotCost: 15489.16","units: 152.1139<br />TotCost: 15609.75","units: 157.6709<br />TotCost: 15730.34","units: 163.2278<br />TotCost: 15850.94","units: 168.7848<br />TotCost: 15971.53","units: 174.3418<br />TotCost: 16092.13","units: 179.8987<br />TotCost: 16212.72","units: 185.4557<br />TotCost: 16333.32","units: 191.0127<br />TotCost: 16453.91","units: 196.5696<br />TotCost: 16574.51","units: 202.1266<br />TotCost: 16695.10","units: 207.6835<br />TotCost: 16815.70","units: 213.2405<br />TotCost: 16936.29","units: 218.7975<br />TotCost: 17056.89","units: 224.3544<br />TotCost: 17177.48","units: 229.9114<br />TotCost: 17298.08","units: 235.4684<br />TotCost: 17418.67","units: 241.0253<br />TotCost: 17539.27","units: 246.5823<br />TotCost: 17659.86","units: 252.1392<br />TotCost: 17780.45","units: 257.6962<br />TotCost: 17901.05","units: 263.2532<br />TotCost: 18021.64","units: 268.8101<br />TotCost: 18142.24","units: 274.3671<br />TotCost: 18262.83","units: 279.9241<br />TotCost: 18383.43","units: 285.4810<br />TotCost: 18504.02","units: 291.0380<br />TotCost: 18624.62","units: 296.5949<br />TotCost: 18745.21","units: 302.1519<br />TotCost: 18865.81","units: 307.7089<br />TotCost: 18986.40","units: 313.2658<br />TotCost: 19107.00","units: 318.8228<br />TotCost: 19227.59","units: 324.3797<br />TotCost: 19348.19","units: 329.9367<br />TotCost: 19468.78","units: 335.4937<br />TotCost: 19589.38","units: 341.0506<br />TotCost: 19709.97","units: 346.6076<br />TotCost: 19830.56","units: 352.1646<br />TotCost: 19951.16","units: 357.7215<br />TotCost: 20071.75","units: 363.2785<br />TotCost: 20192.35","units: 368.8354<br />TotCost: 20312.94","units: 374.3924<br />TotCost: 20433.54","units: 379.9494<br />TotCost: 20554.13","units: 385.5063<br />TotCost: 20674.73","units: 391.0633<br />TotCost: 20795.32","units: 396.6203<br />TotCost: 20915.92","units: 402.1772<br />TotCost: 21036.51","units: 407.7342<br />TotCost: 21157.11","units: 413.2911<br />TotCost: 21277.70","units: 418.8481<br />TotCost: 21398.30","units: 424.4051<br />TotCost: 21518.89","units: 429.9620<br />TotCost: 21639.49","units: 435.5190<br />TotCost: 21760.08","units: 441.0759<br />TotCost: 21880.67","units: 446.6329<br />TotCost: 22001.27","units: 452.1899<br />TotCost: 22121.86","units: 457.7468<br />TotCost: 22242.46","units: 463.3038<br />TotCost: 22363.05","units: 468.8608<br />TotCost: 22483.65","units: 474.4177<br />TotCost: 22604.24","units: 479.9747<br />TotCost: 22724.84","units: 485.5316<br />TotCost: 22845.43","units: 491.0886<br />TotCost: 22966.03","units: 496.6456<br />TotCost: 23086.62","units: 502.2025<br />TotCost: 23207.22","units: 507.7595<br />TotCost: 23327.81","units: 513.3165<br />TotCost: 23448.41","units: 518.8734<br />TotCost: 23569.00","units: 524.4304<br />TotCost: 23689.59","units: 529.9873<br />TotCost: 23810.19","units: 535.5443<br />TotCost: 23930.78","units: 541.1013<br />TotCost: 24051.38","units: 546.6582<br />TotCost: 24171.97","units: 552.2152<br />TotCost: 24292.57","units: 557.7722<br />TotCost: 24413.16","units: 563.3291<br />TotCost: 24533.76","units: 568.8861<br />TotCost: 24654.35","units: 574.4430<br />TotCost: 24774.95","units: 580.0000<br />TotCost: 24895.54","units: 580.0000<br />TotCost: 24895.54","units: 580.0000<br />TotCost: 24895.54","units: 574.4430<br />TotCost: 24774.95","units: 568.8861<br />TotCost: 24654.35","units: 563.3291<br />TotCost: 24533.76","units: 557.7722<br />TotCost: 24413.16","units: 552.2152<br />TotCost: 24292.57","units: 546.6582<br />TotCost: 24171.97","units: 541.1013<br />TotCost: 24051.38","units: 535.5443<br />TotCost: 23930.78","units: 529.9873<br />TotCost: 23810.19","units: 524.4304<br />TotCost: 23689.59","units: 518.8734<br />TotCost: 23569.00","units: 513.3165<br />TotCost: 23448.41","units: 507.7595<br />TotCost: 23327.81","units: 502.2025<br />TotCost: 23207.22","units: 496.6456<br />TotCost: 23086.62","units: 491.0886<br />TotCost: 22966.03","units: 485.5316<br />TotCost: 22845.43","units: 479.9747<br />TotCost: 22724.84","units: 474.4177<br />TotCost: 22604.24","units: 468.8608<br />TotCost: 22483.65","units: 463.3038<br />TotCost: 22363.05","units: 457.7468<br />TotCost: 22242.46","units: 452.1899<br />TotCost: 22121.86","units: 446.6329<br />TotCost: 22001.27","units: 441.0759<br />TotCost: 21880.67","units: 435.5190<br />TotCost: 21760.08","units: 429.9620<br />TotCost: 21639.49","units: 424.4051<br />TotCost: 21518.89","units: 418.8481<br />TotCost: 21398.30","units: 413.2911<br />TotCost: 21277.70","units: 407.7342<br />TotCost: 21157.11","units: 402.1772<br />TotCost: 21036.51","units: 396.6203<br />TotCost: 20915.92","units: 391.0633<br />TotCost: 20795.32","units: 385.5063<br />TotCost: 20674.73","units: 379.9494<br />TotCost: 20554.13","units: 374.3924<br />TotCost: 20433.54","units: 368.8354<br />TotCost: 20312.94","units: 363.2785<br />TotCost: 20192.35","units: 357.7215<br />TotCost: 20071.75","units: 352.1646<br />TotCost: 19951.16","units: 346.6076<br />TotCost: 19830.56","units: 341.0506<br />TotCost: 19709.97","units: 335.4937<br />TotCost: 19589.38","units: 329.9367<br />TotCost: 19468.78","units: 324.3797<br />TotCost: 19348.19","units: 318.8228<br />TotCost: 19227.59","units: 313.2658<br />TotCost: 19107.00","units: 307.7089<br />TotCost: 18986.40","units: 302.1519<br />TotCost: 18865.81","units: 296.5949<br />TotCost: 18745.21","units: 291.0380<br />TotCost: 18624.62","units: 285.4810<br />TotCost: 18504.02","units: 279.9241<br />TotCost: 18383.43","units: 274.3671<br />TotCost: 18262.83","units: 268.8101<br />TotCost: 18142.24","units: 263.2532<br />TotCost: 18021.64","units: 257.6962<br />TotCost: 17901.05","units: 252.1392<br />TotCost: 17780.45","units: 246.5823<br />TotCost: 17659.86","units: 241.0253<br />TotCost: 17539.27","units: 235.4684<br />TotCost: 17418.67","units: 229.9114<br />TotCost: 17298.08","units: 224.3544<br />TotCost: 17177.48","units: 218.7975<br />TotCost: 17056.89","units: 213.2405<br />TotCost: 16936.29","units: 207.6835<br />TotCost: 16815.70","units: 202.1266<br />TotCost: 16695.10","units: 196.5696<br />TotCost: 16574.51","units: 191.0127<br />TotCost: 16453.91","units: 185.4557<br />TotCost: 16333.32","units: 179.8987<br />TotCost: 16212.72","units: 174.3418<br />TotCost: 16092.13","units: 168.7848<br />TotCost: 15971.53","units: 163.2278<br />TotCost: 15850.94","units: 157.6709<br />TotCost: 15730.34","units: 152.1139<br />TotCost: 15609.75","units: 146.5570<br />TotCost: 15489.16","units: 141.0000<br />TotCost: 15368.56","units: 141.0000<br />TotCost: 15368.56"],"type":"scatter","mode":"lines","line":{"width":3.77952755905512,"color":"rgba(55,17,66,0.4)","dash":"solid"},"fill":"toself","fillcolor":"rgba(191,191,191,0.4)","hoveron":"points","hoverinfo":"x+y","showlegend":false,"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":23.9147640791476,"r":7.30593607305936,"b":37.869101978691,"l":54.7945205479452},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[119.05,601.95],"tickmode":"array","ticktext":["200","300","400","500","600"],"tickvals":[200,300,400,500,600],"categoryorder":"array","categoryarray":["200","300","400","500","600"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Units","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[13808.4359376416,25898.4922095265],"tickmode":"array","ticktext":["14000","16000","18000","20000","22000","24000"],"tickvals":[14000,16000,18000,20000,22000,24000],"categoryorder":"array","categoryarray":["14000","16000","18000","20000","22000","24000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Total Costs per period","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"c9aa161634c1":{"x":{},"y":{},"type":"scatter"},"c9aabe1763b":{"x":{},"y":{}}},"cur_data":"c9aa161634c1","visdat":{"c9aa161634c1":["function (y) ","x"],"c9aabe1763b":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>

---
### A Linear Model


```r
Model.HMB &lt;- lm(TotCost ~ units, data=HMB)
summary(Model.HMB)
```

```

Call:
lm(formula = TotCost ~ units, data = HMB)

Residuals:
    Min      1Q  Median      3Q     Max 
-1606.7  -610.9  -124.8   509.8  2522.3 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 12308.642    323.601   38.04   &lt;2e-16 ***
units          21.702      0.862   25.18   &lt;2e-16 ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 871.8 on 58 degrees of freedom
Multiple R-squared:  0.9162,	Adjusted R-squared:  0.9147 
F-statistic: 633.8 on 1 and 58 DF,  p-value: &lt; 2.2e-16
```

`$$Total.Cost_{t} = 12308.64 + 21.70 * units_t + \epsilon_{t}$$`
where `\(\epsilon_{t}\)` has a standard deviation of 872 dollars.

---
### `fitted.values()` or predictions

The line is the fitted values.


```r
data.frame(units=HMB$units, TotCost = HMB$TotCost, Fitted = fitted.values(Model.HMB)) %&gt;% ggplot() + aes(x=units, y=TotCost) + geom_point() + geom_line(aes(x=units, y=Fitted)) + scale_x_continuous(limits=c(0,600)) + scale_y_continuous(limits=c(0,25000))
```

&lt;img src="index_files/figure-html/unnamed-chunk-26-1.svg" width="468" /&gt;

---
### Residual Costs?


```r
data.frame(Residual.Cost = residuals(Model.HMB)) %&gt;% ggplot() + aes(sample=Residual.Cost) + geom_qq() + geom_qq_line()
```

&lt;img src="index_files/figure-html/unnamed-chunk-27-1.svg" width="468" /&gt;

---
## Not the Prettiest but the best....


```r
car::qqPlot(residuals(Model.HMB))
```

&lt;img src="index_files/figure-html/unnamed-chunk-28-1.svg" width="468" /&gt;

---
## Because normal is sustainable, I can ....

- Interpret the table including `\(t\)` and `\(F\)`.  
- Utilize confidence intervals for the estimates.  
- Predict from the regression of two forms.  
- Subject to examinations of other characteristics of the regression.

---
### `anova` [Sums of squares]


```r
anova(Model.HMB)
```

```
Analysis of Variance Table

Response: TotCost
          Df    Sum Sq   Mean Sq F value    Pr(&gt;F)    
units      1 481694173 481694173  633.81 &lt; 2.2e-16 ***
Residuals 58  44080089    760002                      
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

Two types of squares: those a function of units and those residual.  Why?

![](https://www.math.tamu.edu/~don.allen/history/pythag/pyth_pic.gif)



---
### `confint` [confidence intervals]

From normal, the slope and intercept have `\(t\)` confidence intervals.


```r
confint(Model.HMB,level = 0.95)
```

```
                  2.5 %      97.5 %
(Intercept) 11660.88464 12956.39966
units          19.97605    23.42705
```

With 95% confidence, fixed costs range from 11660.88 to 12956.40 dollars per period and the variable costs range from 19.976 to 23.427 dollars per unit.  If the goal is to attain 20 dollars per unit, we cannot rule that out [though a 95 percent lower bound would].


```r
confint(Model.HMB,level = 0.9)
```

```
                    5 %        95 %
(Intercept) 11767.72623 12849.55807
units          20.26066    23.14245
```

---
## Plots


```r
RegressionPlots(Model.HMB)
```

<div id="htmlwidget-159b822bd6daa6e5646c" style="width:468px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-159b822bd6daa6e5646c">{"x":{"data":[{"x":[18124.657840609,18363.3749024507,21640.3091150036,15368.5608538923,21249.6811956265,24765.3324700211,22204.5494429929,16562.1461631004,20685.4408676372,17907.642329844,22074.3401365338,19166.3322922815,19947.5881310359,18645.4950664453,18016.1500852265,23701.9564672721,15411.9639560453,18102.9562895326,19383.3478030466,22291.3556472989,24895.5417764801,24591.720061409,16128.1151415702,16844.266327095,20989.2625827084,22009.2354833043,20121.200539648,16410.2353055648,15585.5763646574,22530.0727091405,21097.7703380909,23289.6269968184,20468.4253568721,18146.3593916856,22790.4913220587,21727.1153193097,16063.0104883406,17017.8787357071,17321.7004507782,16084.7120394171,16345.1306523353,18602.0919642923,16779.1616738655,16041.3089372641,22508.371158064,15759.1887732695,24114.2859377258,21596.9060128506,21813.9215236157,22942.4021795942,17625.5221658493,24157.6890398788,24331.3014484909,20945.8594805553,19882.4834778064,19513.5571095057,20837.3517251728,18732.3012707513,23528.34405866,23029.2083839003],"y":[1499.64988939099,-1572.95998245067,-151.20234500365,629.465886107683,2522.26447437353,-399.856870021059,1520.2884370071,366.828666899644,52.7680523627831,-159.979409843964,-594.125626533844,-1606.74232228153,-215.680721035885,649.705433554702,-187.193085226514,473.47051272792,-1053.98000604534,421.857340467449,704.133946953369,9.67569270105841,-267.575906480119,-1182.18096140898,-818.62832157016,-661.294417094983,-233.661412708353,421.718836695685,-930.868989647964,1757.12177443521,-339.513314657414,-1201.42625914055,-851.828378090904,591.305123181607,-341.768576872119,229.685688314429,494.235657941331,242.319440690312,-1068.57600834063,-1290.95794570706,-896.913330778198,1325.64776058286,1260.07515766474,943.902375707724,-1479.07923386545,1136.79183273588,-98.4198080640418,-273.584453269493,125.717162274236,-821.990112850629,-178.318983615728,-207.557009594237,374.620114150664,283.401350121215,556.527711509137,-329.095690555334,679.295852193646,180.941840494312,-776.965555172785,266.908889248663,-277.22068866,748.820826099724],"mode":"markers","showlegend":false,"text":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60"],"type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[15368.5608538923,15562.9890359859,15757.4172180796,15951.8454001732,16146.2735822668,16340.7017643605,16535.1299464541,16729.5581285477,16923.9863106413,17118.414492735,17312.8426748286,17507.2708569222,17701.6990390159,17896.1272211095,18090.5554032031,18284.9835852967,18479.4117673904,18673.839949484,18868.2681315776,19062.6963136713,19257.1244957649,19451.5526778585,19645.9808599521,19840.4090420458,20034.8372241394,20229.265406233,20423.6935883267,20618.1217704203,20812.5499525139,21006.9781346075,21201.4063167012,21395.8344987948,21590.2626808884,21784.6908629821,21979.1190450757,22173.5472271693,22367.9754092629,22562.4035913566,22756.8317734502,22951.2599555438,23145.6881376375,23340.1163197311,23534.5445018247,23728.9726839183,23923.400866012,24117.8290481056,24312.2572301992,24506.6854122929,24701.1135943865,24895.5417764801],"y":[-98.6500921922085,-89.7170993227608,-80.4551020462132,-71.3645180535304,-62.9366293002146,-54.431646687647,-45.4221546361821,-36.3309882719033,-27.5809827208937,-19.5949731092367,-12.7957945630153,-7.92932071164399,-5.24200971466032,-4.27524708053474,-4.56937702938151,-5.66474378131491,-7.10169155644915,-8.3728945287029,-9.07855354943118,-10.332100978412,-13.5080488005042,-19.9809090005668,-31.1251935634584,-48.3154144740384,-71.7921154189408,-93.7230339900518,-111.628521914184,-124.625800565464,-131.832091318019,-132.364615545976,-125.34059462346,-112.622755041713,-100.147484830637,-87.6155067832782,-74.4309568172841,-59.9979708503017,-46.2927947876485,-36.892382797066,-30.5110930796063,-25.7673924843127,-21.2797478602283,-15.6666260563963,-7.54916430708018,1.47763075898694,9.43718349844003,16.6477356774923,23.4275290623562,30.094805419245,36.9678065143714,44.3647741139481],"mode":"line+lines","showlegend":false,"text":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],"type":"scatter","name":"Smooth","line":{"color":"rgba(255,127,14,1)","width":2},"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1.56891963249893,-1.95996398454005,-0.0208900882468886,0.812217801499913,2.39397979981851,-0.597760126042478,1.73166439612225,0.407918740945035,0.104633455614075,-0.0627067779432138,-0.648492180592857,-2.39397979981851,-0.23183436245301,0.871770972189959,-0.146744955486549,0.597760126042478,-1.15034938037601,0.548522282698098,1.00133129752569,0.0627067779432138,-0.318639363964375,-1.3305615131789,-0.812217801499913,-0.700951419584212,-0.274977748969005,0.50058010546674,-1.07286134165,1.95996398454005,-0.50058010546674,-1.43953147093846,-0.93458929107348,0.755415026360469,-0.548522282698098,0.23183436245301,0.648492180592857,0.274977748969005,-1.23544034156125,-1.56891963249893,-1.00133129752569,1.43953147093846,1.3305615131789,1.15034938037601,-1.73166439612225,1.23544034156125,0.0208900882468884,-0.362917295139356,0.146744955486549,-0.871770972189959,-0.104633455614075,-0.189118426272792,0.45376219016988,0.362917295139356,0.700951419584212,-0.453762190169879,0.93458929107348,0.189118426272792,-0.755415026360469,0.318639363964375,-0.407918740945035,1.07286134165],"y":[1.74084396032636,-1.82436873758369,-0.175436356426609,0.744805681015638,2.92289038413463,-0.474308103604439,1.76814456982398,0.429558423904209,0.0610750273014379,-0.185875128004354,-0.690566671380537,-1.85980792103849,-0.249490326482203,0.752898914369061,-0.217394149955658,0.556029482421977,-1.24656092585923,0.489747592640275,0.814785504160986,0.0112579434465696,-0.317846137113395,-1.39974643050088,-0.961877087526199,-0.772850857002083,-0.270600186830842,0.490031622471933,-1.07682438296639,2.05994374064488,-0.400865807884857,-1.39965309326147,-0.986739652595267,0.692210285800502,-0.395456990933728,0.266604580834995,0.576654263453303,0.281247359631023,-1.25624851625238,-1.50703544347783,-1.04514224576951,1.55818385799741,1.47798114232402,1.09395661506306,-1.72935195592598,1.33669137854545,-0.114644676436818,-0.322497154735846,0.148165978145232,-0.953587925877449,-0.207035085053734,-0.242400183829196,0.435830879753175,0.334140378235023,0.65724261216085,-0.381085637079875,0.785784119092909,0.209347355655953,-0.899514114569292,0.309230805304432,-0.325109390296172,0.875024346144375],"text":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60"],"mode":"markers","marker":{"color":"rgba(44,160,44,1)","size":10,"opacity":0.5,"line":{"color":"rgba(44,160,44,1)"}},"showlegend":false,"type":"scatter","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":[1.56891963249893,-1.95996398454005,-0.0208900882468886,0.812217801499913,2.39397979981851,-0.597760126042478,1.73166439612225,0.407918740945035,0.104633455614075,-0.0627067779432138,-0.648492180592857,-2.39397979981851,-0.23183436245301,0.871770972189959,-0.146744955486549,0.597760126042478,-1.15034938037601,0.548522282698098,1.00133129752569,0.0627067779432138,-0.318639363964375,-1.3305615131789,-0.812217801499913,-0.700951419584212,-0.274977748969005,0.50058010546674,-1.07286134165,1.95996398454005,-0.50058010546674,-1.43953147093846,-0.93458929107348,0.755415026360469,-0.548522282698098,0.23183436245301,0.648492180592857,0.274977748969005,-1.23544034156125,-1.56891963249893,-1.00133129752569,1.43953147093846,1.3305615131789,1.15034938037601,-1.73166439612225,1.23544034156125,0.0208900882468884,-0.362917295139356,0.146744955486549,-0.871770972189959,-0.104633455614075,-0.189118426272792,0.45376219016988,0.362917295139356,0.700951419584212,-0.453762190169879,0.93458929107348,0.189118426272792,-0.755415026360469,0.318639363964375,-0.407918740945035,1.07286134165],"y":[1.56891963249893,-1.95996398454005,-0.0208900882468886,0.812217801499913,2.39397979981851,-0.597760126042478,1.73166439612225,0.407918740945035,0.104633455614075,-0.0627067779432138,-0.648492180592857,-2.39397979981851,-0.23183436245301,0.871770972189959,-0.146744955486549,0.597760126042478,-1.15034938037601,0.548522282698098,1.00133129752569,0.0627067779432138,-0.318639363964375,-1.3305615131789,-0.812217801499913,-0.700951419584212,-0.274977748969005,0.50058010546674,-1.07286134165,1.95996398454005,-0.50058010546674,-1.43953147093846,-0.93458929107348,0.755415026360469,-0.548522282698098,0.23183436245301,0.648492180592857,0.274977748969005,-1.23544034156125,-1.56891963249893,-1.00133129752569,1.43953147093846,1.3305615131789,1.15034938037601,-1.73166439612225,1.23544034156125,0.0208900882468884,-0.362917295139356,0.146744955486549,-0.871770972189959,-0.104633455614075,-0.189118426272792,0.45376219016988,0.362917295139356,0.700951419584212,-0.453762190169879,0.93458929107348,0.189118426272792,-0.755415026360469,0.318639363964375,-0.407918740945035,1.07286134165],"text":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60"],"mode":"line+markers+lines","marker":{"color":"rgba(214,39,40,1)","size":10,"opacity":0.5,"line":{"color":"rgba(214,39,40,1)"}},"showlegend":false,"type":"scatter","line":{"color":"rgba(214,39,40,1)","width":2},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":[18124.657840609,18363.3749024507,21640.3091150036,15368.5608538923,21249.6811956265,24765.3324700211,22204.5494429929,16562.1461631004,20685.4408676372,17907.642329844,22074.3401365338,19166.3322922815,19947.5881310359,18645.4950664453,18016.1500852265,23701.9564672721,15411.9639560453,18102.9562895326,19383.3478030466,22291.3556472989,24895.5417764801,24591.720061409,16128.1151415702,16844.266327095,20989.2625827084,22009.2354833043,20121.200539648,16410.2353055648,15585.5763646574,22530.0727091405,21097.7703380909,23289.6269968184,20468.4253568721,18146.3593916856,22790.4913220587,21727.1153193097,16063.0104883406,17017.8787357071,17321.7004507782,16084.7120394171,16345.1306523353,18602.0919642923,16779.1616738655,16041.3089372641,22508.371158064,15759.1887732695,24114.2859377258,21596.9060128506,21813.9215236157,22942.4021795942,17625.5221658493,24157.6890398788,24331.3014484909,20945.8594805553,19882.4834778064,19513.5571095057,20837.3517251728,18732.3012707513,23528.34405866,23029.2083839003],"y":[1.3194104593819,1.35069194770077,0.418851234242671,0.863021251775203,1.70964627456519,0.688700300279039,1.32971597336573,0.655407067328549,0.247133622361341,0.431132378747356,0.831003412375988,1.36374774831656,0.499490066449977,0.867697478600152,0.466255455684604,0.745673844533907,1.11649492872078,0.699819685805047,0.902654698188065,0.106103456336585,0.56377844683297,1.18310879909706,0.98075332654353,0.879119364479069,0.520192451724207,0.700022587115539,1.03770149029786,1.43525041043188,0.633139643273786,1.18306935268456,0.993347699748314,0.83199175825275,0.628853711870836,0.516337661646906,0.759377550006124,0.530327596520323,1.12082492667338,1.22761371916325,1.02232198732567,1.24827234928817,1.2157224775104,1.04592380939677,1.31504827132923,1.15615370022564,0.338592197838075,0.567888329459099,0.384923340608532,0.976518267047498,0.455011082341666,0.492341531692377,0.660174885733451,0.578048768042129,0.810705009334992,0.617321340210975,0.886444650890798,0.457544922008706,0.948427179370821,0.556085250033151,0.570183646114278,0.935427360164527],"text":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60"],"mode":"markers","marker":{"color":"rgba(148,103,189,1)","size":10,"opacity":0.5,"line":{"color":"rgba(148,103,189,1)"}},"showlegend":false,"type":"scatter","error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"line":{"color":"rgba(148,103,189,1)"},"xaxis":"x3","yaxis":"y3","frame":null},{"x":[15368.5608538923,15562.9890359859,15757.4172180796,15951.8454001732,16146.2735822668,16340.7017643605,16535.1299464541,16729.5581285477,16923.9863106413,17118.414492735,17312.8426748286,17507.2708569222,17701.6990390159,17896.1272211095,18090.5554032031,18284.9835852967,18479.4117673904,18673.839949484,18868.2681315776,19062.6963136713,19257.1244957649,19451.5526778585,19645.9808599521,19840.4090420458,20034.8372241394,20229.265406233,20423.6935883267,20618.1217704203,20812.5499525139,21006.9781346075,21201.4063167012,21395.8344987948,21590.2626808884,21784.6908629821,21979.1190450757,22173.5472271693,22367.9754092629,22562.4035913566,22756.8317734502,22951.2599555438,23145.6881376375,23340.1163197311,23534.5445018247,23728.9726839183,23923.400866012,24117.8290481056,24312.2572301992,24506.6854122929,24701.1135943865,24895.5417764801],"y":[1.03886877914784,1.02785231669077,1.01685802482308,1.00580734118861,0.994625718956433,0.983733274583114,0.973258112617882,0.962922688186368,0.952449456414202,0.941560872427017,0.929979391350442,0.917834903243393,0.905488903286218,0.892904835116103,0.880045297137395,0.866872887754442,0.853350205371594,0.83955833486106,0.826700839862274,0.814984136493094,0.804260932744196,0.794383936606255,0.785205856069944,0.776579399125938,0.768342437396742,0.760333430045386,0.752642898892803,0.745397635722373,0.738724432317476,0.732750080461493,0.727601371937803,0.723337313152019,0.719784625659672,0.716800804198559,0.714248019978153,0.711988444207924,0.710033737543661,0.708521573476466,0.707332200219736,0.706340540373384,0.705421516537319,0.704450051311453,0.703301345839332,0.702152947738046,0.701192719629094,0.700362243064888,0.699603099597841,0.698856870780364,0.69806513816487,0.697169483303771],"text":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],"mode":"line+markers+lines","marker":{"color":"rgba(140,86,75,1)","size":10,"opacity":0.5,"line":{"color":"rgba(140,86,75,1)"}},"showlegend":false,"type":"scatter","name":"Smooth","line":{"color":"rgba(140,86,75,1)","width":2},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x3","yaxis":"y3","frame":null},{"x":[0.0235599159403855,0.0218721273651381,0.0226201408697932,0.0601815516639357,0.0201903354126188,0.0648666087123498,0.0272483603636534,0.0404500556610432,0.0177991169190865,0.0252995883383678,0.0260629844839342,0.0179314337031968,0.0166666677530114,0.0201825137307995,0.0244053093836912,0.0459398334073025,0.0593604054342699,0.023725083788137,0.0173259051690171,0.0280777193592296,0.067506817410464,0.0614558339936679,0.0469407479574492,0.0366505433559408,0.0189224407897057,0.0254966947202149,0.0167297626530206,0.0426328263340905,0.0561540373337998,0.0305197787845876,0.0194165103579599,0.0398640813314119,0.0172313931803669,0.0233967035130888,0.0334536916350176,0.0232461361380668,0.0479818138076019,0.0344766372556221,0.0309734363301086,0.0476328364370962,0.0435976307865046,0.0204209446649253,0.037498022581065,0.0483327465985624,0.0302879962800081,0.0530728161424391,0.0527214922673876,0.0223188757583854,0.0239034181336177,0.0352951762580149,0.0278534978137422,0.0534764149243164,0.0565743223702251,0.0187385009055878,0.0166752716030126,0.0170564482303412,0.0183128710532527,0.0197291169080057,0.0432955835069149,0.0363904724354481],"y":[1499.64988939099,-1572.95998245067,-151.20234500365,629.465886107683,2522.26447437353,-399.856870021059,1520.2884370071,366.828666899644,52.7680523627831,-159.979409843964,-594.125626533844,-1606.74232228153,-215.680721035885,649.705433554702,-187.193085226514,473.47051272792,-1053.98000604534,421.857340467449,704.133946953369,9.67569270105841,-267.575906480119,-1182.18096140898,-818.62832157016,-661.294417094983,-233.661412708353,421.718836695685,-930.868989647964,1757.12177443521,-339.513314657414,-1201.42625914055,-851.828378090904,591.305123181607,-341.768576872119,229.685688314429,494.235657941331,242.319440690312,-1068.57600834063,-1290.95794570706,-896.913330778198,1325.64776058286,1260.07515766474,943.902375707724,-1479.07923386545,1136.79183273588,-98.4198080640418,-273.584453269493,125.717162274236,-821.990112850629,-178.318983615728,-207.557009594237,374.620114150664,283.401350121215,556.527711509137,-329.095690555334,679.295852193646,180.941840494312,-776.965555172785,266.908889248663,-277.22068866,748.820826099724],"text":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60"],"mode":"markers","marker":{"color":"rgba(227,119,194,1)","size":10,"opacity":0.5,"line":{"color":"rgba(227,119,194,1)"}},"showlegend":false,"type":"scatter","error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"line":{"color":"rgba(227,119,194,1)"},"xaxis":"x4","yaxis":"y4","frame":null},{"x":[0.0166666677530114,0.0177042218276533,0.0187417759022951,0.019779329976937,0.0208168840515789,0.0218544381262208,0.0228919922008627,0.0239295462755046,0.0249671003501465,0.0260046544247884,0.0270422084994303,0.0280797625740722,0.0291173166487141,0.030154870723356,0.0311924247979978,0.0322299788726397,0.0332675329472816,0.0343050870219235,0.0353426410965654,0.0363801951712073,0.0374177492458492,0.0384553033204911,0.039492857395133,0.0405304114697749,0.0415679655444168,0.0426055196190587,0.0436430736937005,0.0446806277683424,0.0457181818429843,0.0467557359176262,0.0477932899922681,0.04883084406691,0.0498683981415519,0.0509059522161938,0.0519435062908357,0.0529810603654776,0.0540186144401195,0.0550561685147613,0.0560937225894032,0.0571312766640451,0.058168830738687,0.0592063848133289,0.0602439388879708,0.0612814929626127,0.0623190470372546,0.0633566011118965,0.0643941551865384,0.0654317092611803,0.0664692633358222,0.067506817410464],"y":[-122.228240164125,-104.481984326376,-90.6497422342466,-76.8801619524414,-66.5770629871765,-58.4573869438929,-52.1975427207975,-47.8239934177026,-47.5497524714017,-54.368830932318,-70.7366436105604,-98.2730281927467,-116.142487440588,-117.043048366141,-104.526980204053,-82.1465521889716,-53.4540335555433,-22.001693538416,8.65819862776334,34.9733737083474,52.9261984977638,62.7028299551864,67.1477429715965,69.1055636199044,71.42091797302,76.9384321038533,88.4829719882529,97.5587738591112,96.7676754418222,87.98171320113,73.0729236017785,53.9133431085117,32.3750081860737,10.3299552992081,-10.3497790873407,-27.7921585088288,-41.3292792773975,-56.3098663945732,-73.3886956533735,-92.2755843043416,-112.680349598021,-134.312808784956,-156.882779115689,-180.100077840764,-203.674522210725,-227.315929476115,-250.734116887478,-273.638901695356,-295.740101150295,-316.747532502837],"text":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],"mode":"line+markers+lines","marker":{"color":"rgba(127,127,127,1)","size":10,"opacity":0.5,"line":{"color":"rgba(127,127,127,1)"}},"showlegend":false,"type":"scatter","name":"Smooth","line":{"color":"rgba(127,127,127,1)","width":2},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"xaxis":"x4","yaxis":"y4","frame":null}],"layout":{"xaxis":{"domain":[0,0.48],"automargin":true,"text":"Residuals","anchor":"y"},"xaxis2":{"domain":[0.52,1],"automargin":true,"text":"Theoretical","anchor":"y2"},"xaxis3":{"domain":[0,0.48],"automargin":true,"text":"Scale","anchor":"y3"},"xaxis4":{"domain":[0.52,1],"automargin":true,"text":"Leverage","anchor":"y4"},"yaxis4":{"domain":[0,0.48],"automargin":true,"text":"Residuals","anchor":"x4"},"yaxis3":{"domain":[0,0.48],"automargin":true,"text":"Location","anchor":"x3"},"yaxis2":{"domain":[0.52,1],"automargin":true,"text":"Standardized Residuals","anchor":"x2"},"yaxis":{"domain":[0.52,1],"automargin":true,"text":"Fitted Values","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"plot_bgcolor":"#e6e6e6","hovermode":"closest","showlegend":false},"attrs":{"c9aa14c9d44a":{"x":{},"y":{},"mode":"markers","showlegend":false,"text":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"c9aa14c9d44a.1":{"x":[15368.5608538923,15562.9890359859,15757.4172180796,15951.8454001732,16146.2735822668,16340.7017643605,16535.1299464541,16729.5581285477,16923.9863106413,17118.414492735,17312.8426748286,17507.2708569222,17701.6990390159,17896.1272211095,18090.5554032031,18284.9835852967,18479.4117673904,18673.839949484,18868.2681315776,19062.6963136713,19257.1244957649,19451.5526778585,19645.9808599521,19840.4090420458,20034.8372241394,20229.265406233,20423.6935883267,20618.1217704203,20812.5499525139,21006.9781346075,21201.4063167012,21395.8344987948,21590.2626808884,21784.6908629821,21979.1190450757,22173.5472271693,22367.9754092629,22562.4035913566,22756.8317734502,22951.2599555438,23145.6881376375,23340.1163197311,23534.5445018247,23728.9726839183,23923.400866012,24117.8290481056,24312.2572301992,24506.6854122929,24701.1135943865,24895.5417764801],"y":[-98.6500921922085,-89.7170993227608,-80.4551020462132,-71.3645180535304,-62.9366293002146,-54.431646687647,-45.4221546361821,-36.3309882719033,-27.5809827208937,-19.5949731092367,-12.7957945630153,-7.92932071164399,-5.24200971466032,-4.27524708053474,-4.56937702938151,-5.66474378131491,-7.10169155644915,-8.3728945287029,-9.07855354943118,-10.332100978412,-13.5080488005042,-19.9809090005668,-31.1251935634584,-48.3154144740384,-71.7921154189408,-93.7230339900518,-111.628521914184,-124.625800565464,-131.832091318019,-132.364615545976,-125.34059462346,-112.622755041713,-100.147484830637,-87.6155067832782,-74.4309568172841,-59.9979708503017,-46.2927947876485,-36.892382797066,-30.5110930796063,-25.7673924843127,-21.2797478602283,-15.6666260563963,-7.54916430708018,1.47763075898694,9.43718349844003,16.6477356774923,23.4275290623562,30.094805419245,36.9678065143714,44.3647741139481],"mode":"line","showlegend":false,"text":"","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","name":"Smooth","line":{"width":2},"inherit":true},"c9aa4e9050ef":{"x":{},"y":{},"text":{},"mode":"markers","marker":{"size":10,"opacity":0.5},"showlegend":false,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"c9aa4e9050ef.1":{"x":[1.56891963249893,-1.95996398454005,-0.0208900882468886,0.812217801499913,2.39397979981851,-0.597760126042478,1.73166439612225,0.407918740945035,0.104633455614075,-0.0627067779432138,-0.648492180592857,-2.39397979981851,-0.23183436245301,0.871770972189959,-0.146744955486549,0.597760126042478,-1.15034938037601,0.548522282698098,1.00133129752569,0.0627067779432138,-0.318639363964375,-1.3305615131789,-0.812217801499913,-0.700951419584212,-0.274977748969005,0.50058010546674,-1.07286134165,1.95996398454005,-0.50058010546674,-1.43953147093846,-0.93458929107348,0.755415026360469,-0.548522282698098,0.23183436245301,0.648492180592857,0.274977748969005,-1.23544034156125,-1.56891963249893,-1.00133129752569,1.43953147093846,1.3305615131789,1.15034938037601,-1.73166439612225,1.23544034156125,0.0208900882468884,-0.362917295139356,0.146744955486549,-0.871770972189959,-0.104633455614075,-0.189118426272792,0.45376219016988,0.362917295139356,0.700951419584212,-0.453762190169879,0.93458929107348,0.189118426272792,-0.755415026360469,0.318639363964375,-0.407918740945035,1.07286134165],"y":[1.56891963249893,-1.95996398454005,-0.0208900882468886,0.812217801499913,2.39397979981851,-0.597760126042478,1.73166439612225,0.407918740945035,0.104633455614075,-0.0627067779432138,-0.648492180592857,-2.39397979981851,-0.23183436245301,0.871770972189959,-0.146744955486549,0.597760126042478,-1.15034938037601,0.548522282698098,1.00133129752569,0.0627067779432138,-0.318639363964375,-1.3305615131789,-0.812217801499913,-0.700951419584212,-0.274977748969005,0.50058010546674,-1.07286134165,1.95996398454005,-0.50058010546674,-1.43953147093846,-0.93458929107348,0.755415026360469,-0.548522282698098,0.23183436245301,0.648492180592857,0.274977748969005,-1.23544034156125,-1.56891963249893,-1.00133129752569,1.43953147093846,1.3305615131789,1.15034938037601,-1.73166439612225,1.23544034156125,0.0208900882468884,-0.362917295139356,0.146744955486549,-0.871770972189959,-0.104633455614075,-0.189118426272792,0.45376219016988,0.362917295139356,0.700951419584212,-0.453762190169879,0.93458929107348,0.189118426272792,-0.755415026360469,0.318639363964375,-0.407918740945035,1.07286134165],"text":{},"mode":"line","marker":{"size":10,"opacity":0.5},"showlegend":false,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","name":"","line":{"width":2},"inherit":true},"c9aa64b1a334":{"x":{},"y":{},"text":{},"mode":"markers","marker":{"size":10,"opacity":0.5},"showlegend":false,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"c9aa64b1a334.1":{"x":[15368.5608538923,15562.9890359859,15757.4172180796,15951.8454001732,16146.2735822668,16340.7017643605,16535.1299464541,16729.5581285477,16923.9863106413,17118.414492735,17312.8426748286,17507.2708569222,17701.6990390159,17896.1272211095,18090.5554032031,18284.9835852967,18479.4117673904,18673.839949484,18868.2681315776,19062.6963136713,19257.1244957649,19451.5526778585,19645.9808599521,19840.4090420458,20034.8372241394,20229.265406233,20423.6935883267,20618.1217704203,20812.5499525139,21006.9781346075,21201.4063167012,21395.8344987948,21590.2626808884,21784.6908629821,21979.1190450757,22173.5472271693,22367.9754092629,22562.4035913566,22756.8317734502,22951.2599555438,23145.6881376375,23340.1163197311,23534.5445018247,23728.9726839183,23923.400866012,24117.8290481056,24312.2572301992,24506.6854122929,24701.1135943865,24895.5417764801],"y":[1.03886877914784,1.02785231669077,1.01685802482308,1.00580734118861,0.994625718956433,0.983733274583114,0.973258112617882,0.962922688186368,0.952449456414202,0.941560872427017,0.929979391350442,0.917834903243393,0.905488903286218,0.892904835116103,0.880045297137395,0.866872887754442,0.853350205371594,0.83955833486106,0.826700839862274,0.814984136493094,0.804260932744196,0.794383936606255,0.785205856069944,0.776579399125938,0.768342437396742,0.760333430045386,0.752642898892803,0.745397635722373,0.738724432317476,0.732750080461493,0.727601371937803,0.723337313152019,0.719784625659672,0.716800804198559,0.714248019978153,0.711988444207924,0.710033737543661,0.708521573476466,0.707332200219736,0.706340540373384,0.705421516537319,0.704450051311453,0.703301345839332,0.702152947738046,0.701192719629094,0.700362243064888,0.699603099597841,0.698856870780364,0.69806513816487,0.697169483303771],"text":"","mode":"line","marker":{"size":10,"opacity":0.5},"showlegend":false,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","name":"Smooth","line":{"width":2},"inherit":true},"c9aa4a51de91":{"x":{},"y":{},"text":{},"mode":"markers","marker":{"size":10,"opacity":0.5},"showlegend":false,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"c9aa4a51de91.1":{"x":[0.0166666677530114,0.0177042218276533,0.0187417759022951,0.019779329976937,0.0208168840515789,0.0218544381262208,0.0228919922008627,0.0239295462755046,0.0249671003501465,0.0260046544247884,0.0270422084994303,0.0280797625740722,0.0291173166487141,0.030154870723356,0.0311924247979978,0.0322299788726397,0.0332675329472816,0.0343050870219235,0.0353426410965654,0.0363801951712073,0.0374177492458492,0.0384553033204911,0.039492857395133,0.0405304114697749,0.0415679655444168,0.0426055196190587,0.0436430736937005,0.0446806277683424,0.0457181818429843,0.0467557359176262,0.0477932899922681,0.04883084406691,0.0498683981415519,0.0509059522161938,0.0519435062908357,0.0529810603654776,0.0540186144401195,0.0550561685147613,0.0560937225894032,0.0571312766640451,0.058168830738687,0.0592063848133289,0.0602439388879708,0.0612814929626127,0.0623190470372546,0.0633566011118965,0.0643941551865384,0.0654317092611803,0.0664692633358222,0.067506817410464],"y":[-122.228240164125,-104.481984326376,-90.6497422342466,-76.8801619524414,-66.5770629871765,-58.4573869438929,-52.1975427207975,-47.8239934177026,-47.5497524714017,-54.368830932318,-70.7366436105604,-98.2730281927467,-116.142487440588,-117.043048366141,-104.526980204053,-82.1465521889716,-53.4540335555433,-22.001693538416,8.65819862776334,34.9733737083474,52.9261984977638,62.7028299551864,67.1477429715965,69.1055636199044,71.42091797302,76.9384321038533,88.4829719882529,97.5587738591112,96.7676754418222,87.98171320113,73.0729236017785,53.9133431085117,32.3750081860737,10.3299552992081,-10.3497790873407,-27.7921585088288,-41.3292792773975,-56.3098663945732,-73.3886956533735,-92.2755843043416,-112.680349598021,-134.312808784956,-156.882779115689,-180.100077840764,-203.674522210725,-227.315929476115,-250.734116887478,-273.638901695356,-295.740101150295,-316.747532502837],"text":"","mode":"line","marker":{"size":10,"opacity":0.5},"showlegend":false,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","name":"Smooth","line":{"width":2},"inherit":true}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>

---
### Predicting Costs

### Average Costs `interval="confidence"`


```r
predict(Model.HMB, newdata=data.frame(units=c(200,250,300)), interval="confidence")
```

```
       fit      lwr      upr
1 16648.95 16303.25 16994.66
2 17734.03 17448.18 18019.88
3 18819.11 18576.63 19061.58
```

### All Costs `interval="prediction"`


```r
predict(Model.HMB, newdata=data.frame(units=c(200,250,300)), interval="prediction")
```

```
       fit      lwr      upr
1 16648.95 14869.98 18427.92
2 17734.03 15965.71 19502.35
3 18819.11 17057.28 20580.93
```


---
### Diminshing Marginal Cost?


```r
Semiconductors %&gt;% ggplot() + aes(x=units, y=TotCost4) + geom_point() + geom_smooth(method = "lm") + geom_smooth(method = "loess", color="red") + theme_xaringan() + labs(x="Units", y="Total Cost", title="Semiconductors")
```

&lt;img src="index_files/figure-html/unnamed-chunk-35-1.svg" width="468" /&gt;

---
## Residuals


```r
SClm &lt;- lm(TotCost4~units, data=Semiconductors)
SClm2 &lt;- lm(TotCost4~poly(units, 2, raw=TRUE), data=Semiconductors)
par(mfrow=c(2,2))
plot(SClm)
```

&lt;img src="index_files/figure-html/unnamed-chunk-36-1.svg" width="468" /&gt;

---
## Residuals


```r
resid.plotter(SClm2)
```

&lt;img src="index_files/figure-html/unnamed-chunk-37-1.svg" width="468" /&gt;



---
## Comparing Squares


```r
anova(SClm,SClm2)
```

```
Analysis of Variance Table

Model 1: TotCost4 ~ units
Model 2: TotCost4 ~ poly(units, 2, raw = TRUE)
  Res.Df       RSS Df Sum of Sq     F      Pr(&gt;F)    
1     58 304149603                                   
2     57 203027172  1 101122431 28.39 0.000001757 ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

---
## Line*s*?


```r
PPlm &lt;- lm(TotCost3 ~ units:PlantFac, data=PowerPlant)
PowerPlant %&gt;% ggplot() + aes(x=units, y=TotCost3, color=PlantFac) + geom_point() + geom_smooth(method = "lm") + theme_xaringan() + labs(x="Units", y="Total Cost", title="Power Plant")
```

&lt;img src="index_files/figure-html/unnamed-chunk-39-1.svg" width="468" /&gt;
---
## Comparison

`test` or `anova`


```r
PPlm1 &lt;- lm(TotCost3~units, data=PowerPlant)
PPlm2 &lt;- lm(TotCost3~PlantFac*units, data=PowerPlant)
anova(PPlm1,PPlm)
```

```
Analysis of Variance Table

Model 1: TotCost3 ~ units
Model 2: TotCost3 ~ units:PlantFac
  Res.Df       RSS Df Sum of Sq      F       Pr(&gt;F)    
1     58 585943761                                     
2     56 348638405  2 237305356 19.059 0.0000004859 ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

---


```r
anova(PPlm,PPlm2)
```

```
Analysis of Variance Table

Model 1: TotCost3 ~ units:PlantFac
Model 2: TotCost3 ~ PlantFac * units
  Res.Df       RSS Df Sum of Sq      F Pr(&gt;F)
1     56 348638405                           
2     54 345221354  2   3417052 0.2672 0.7665
```


---
## The Premier League


```r
Model.EPL &lt;- lm(Points ~ Wage.Bill.milGBP, data=EPL)
summary(Model.EPL)
```

```

Call:
lm(formula = Points ~ Wage.Bill.milGBP, data = EPL)

Residuals:
    Min      1Q  Median      3Q     Max 
-12.569  -3.201   0.353   3.712  11.129 

Coefficients:
                 Estimate Std. Error t value       Pr(&gt;|t|)
(Intercept)      32.11589    2.74905  11.683 0.000000000776
Wage.Bill.milGBP  0.24023    0.02987   8.042 0.000000227415
                    
(Intercept)      ***
Wage.Bill.milGBP ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.438 on 18 degrees of freedom
Multiple R-squared:  0.7823,	Adjusted R-squared:  0.7702 
F-statistic: 64.67 on 1 and 18 DF,  p-value: 0.0000002274
```
`$$Points = 32.12 + 0.24*Wage.Bill + \epsilon$$`

---


```r
EPL$FV &lt;- fitted.values(Model.EPL)
PP &lt;- ggplot(EPL) + aes(x=Wage.Bill.milGBP, y=Points, text=Team) + geom_point() + geom_smooth(method="lm", color="black")
PP
```

&lt;img src="index_files/figure-html/unnamed-chunk-43-1.svg" width="468" /&gt;

---


```r
plotly::ggplotly(PP)
```

<div id="htmlwidget-638421d10d129c992d5b" style="width:468px;height:432px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-638421d10d129c992d5b">{"x":{"data":[{"x":[124,83,38,50,25,56,190,58,58,135,174,153,54,47,61,91,37,56,40,38],"y":[68,48,39,43,39,46,71,54,49,58,71,80,46,46,47,62,47,33,42,30],"text":["Wage.Bill.milGBP: 124<br />Points: 68<br />Arsenal","Wage.Bill.milGBP:  83<br />Points: 48<br />Aston Villa","Wage.Bill.milGBP:  38<br />Points: 39<br />Birmingham City","Wage.Bill.milGBP:  50<br />Points: 43<br />Blackburn Rovers","Wage.Bill.milGBP:  25<br />Points: 39<br />Blackpool","Wage.Bill.milGBP:  56<br />Points: 46<br />Bolton Wanderers","Wage.Bill.milGBP: 190<br />Points: 71<br />Chelsea","Wage.Bill.milGBP:  58<br />Points: 54<br />Everton","Wage.Bill.milGBP:  58<br />Points: 49<br />Fulham","Wage.Bill.milGBP: 135<br />Points: 58<br />Liverpool","Wage.Bill.milGBP: 174<br />Points: 71<br />Manchester City","Wage.Bill.milGBP: 153<br />Points: 80<br />Manchester United","Wage.Bill.milGBP:  54<br />Points: 46<br />Newcastle United","Wage.Bill.milGBP:  47<br />Points: 46<br />Stoke City","Wage.Bill.milGBP:  61<br />Points: 47<br />Sunderland","Wage.Bill.milGBP:  91<br />Points: 62<br />Tottenham Hotspur","Wage.Bill.milGBP:  37<br />Points: 47<br />West Bromwich Albion","Wage.Bill.milGBP:  56<br />Points: 33<br />West Ham United","Wage.Bill.milGBP:  40<br />Points: 42<br />Wigan Athletic","Wage.Bill.milGBP:  38<br />Points: 30<br />Wolverhampton Wanderers"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(55,17,66,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(55,17,66,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"visible":false,"showlegend":false,"xaxis":null,"yaxis":null,"hoverinfo":"text","frame":null}],"layout":{"margin":{"t":23.9147640791476,"r":7.30593607305936,"b":37.869101978691,"l":37.2602739726027},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[16.75,198.25],"tickmode":"array","ticktext":["50","100","150"],"tickvals":[50,100,150],"categoryorder":"array","categoryarray":["50","100","150"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Wage.Bill.milGBP","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[27.5,82.5],"tickmode":"array","ticktext":["30","40","50","60","70","80"],"tickvals":[30,40,50,60,70,80],"categoryorder":"array","categoryarray":["30","40","50","60","70","80"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Points","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"c9aa800e2ee":{"x":{},"y":{},"text":{},"type":"scatter"},"c9aa72327b5c":{"x":{},"y":{},"text":{}}},"cur_data":"c9aa800e2ee","visdat":{"c9aa800e2ee":["function (y) ","x"],"c9aa72327b5c":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>

---
# Not Unreasonable


```r
qqnorm(residuals(Model.EPL))
```

&lt;img src="index_files/figure-html/unnamed-chunk-45-1.svg" width="468" /&gt;

---
## Residuals


```r
resid.plotter(Model.EPL)
```

&lt;img src="index_files/figure-html/unnamed-chunk-46-1.svg" width="468" /&gt;


---
# Predicting Points


```r
head(predict(Model.EPL, newdata=data.frame(Wage.Bill.milGBP=seq(0,200,10)), interval = "confidence"), 10)
```

```
        fit      lwr      upr
1  32.11589 26.34036 37.89143
2  34.51820 29.26702 39.76939
3  36.92051 32.16859 41.67244
4  39.32282 35.03629 43.60936
5  41.72513 37.85788 45.59239
6  44.12744 40.61679 47.63809
7  46.52975 43.29225 49.76725
8  48.93206 45.86190 52.00222
9  51.33437 48.30814 54.36060
10 53.73668 50.62574 56.84762
```


---

## Some Concluding Remarks

1. It's all about squares.  But really, it's all about *normals*.  
2. Assessing normality is crucial to inference in linear models.  But we cannot really **know** whether or not it holds.  But if it does:  
   a. Slopes and intercepts are `t`,  as are their confidence intervals.  
   b. Sums of squares have ratios defined by `F`.  
   c. Predictions have `t` averages and `normal` intervals.  
   d. **All founded upon the sum of squared errors being `\(\chi^2\)`.**  
3. This core idea of **explaining variance** or unpacking a black box is the core question to virtually all *machine learning* and modelling.  
4. The capital asset pricing model.

   
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>
<style>
.logo {
  background-image: url(logo.png);
  background-size: contain;
  background-repeat: no-repeat;
  position: absolute;
  top: 1em;
  right: 1em;
  width: 110px;
  height: 128px;
  z-index: 0;
}
</style>

<script>
document
  .querySelectorAll(
    '.remark-slide-content' +
    ':not(.title-slide)' +
    // add additional classes to exclude here, e.g.
    // ':not(.inverse)' +
    ':not(.hide-logo)'
  )
  .forEach(el => {
    el.innerHTML += '<div class="logo"></div>';
  });
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
